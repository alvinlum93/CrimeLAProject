---
title: "status description&Time"
author: "Jie"
date: "2017/10/7"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
status<-sapply(crime_data$Status.Description,as.character)
f1<-group_by(crime_data,Status.Description)%>%summarise(count=n())


#categorize the Status Description in to 3 type: Arrested,invest cont and other
levels(crime_data$Status.Description)[levels(crime_data$Status.Description)=="Adult Arrest"] <- "Arrested"
levels(crime_data$Status.Description)[levels(crime_data$Status.Description)=="Juv Arrest"] <- "Arrested"
levels(crime_data$Status.Description)[levels(crime_data$Status.Description)=="Juv Other"] <- "Other"
levels(crime_data$Status.Description)[levels(crime_data$Status.Description)=="Adult Other"] <- "Other"
levels(crime_data$Status.Description)[levels(crime_data$Status.Description)=="UNK"] <- "Other"
ggplot(crime_data)+geom_bar(aes(x=crime_type))+facet_wrap(~Status.Description)+theme(axis.text = element_text(angle = 45,hjust = 1))


```

```{r}
f2<-group_by(crime_data,Time.Between.Occured.Reported)%>%summarise(count=n())


time_func <- function(numb){
  if(numb <3){return("less than 3 days")
  } else if(numb >=3 & numb < 10 ){return("3 days to 10 days")
    } else if(numb >=10 & numb < 15 ){return("10 days to 15 days")
    } else if(numb >= 15) {return("more than 15 days")}
}

crime_data$Time.Between.Occured.Reported.Global = sapply(crime_data$Time.Between.Occured.Reported, time_func)
```


